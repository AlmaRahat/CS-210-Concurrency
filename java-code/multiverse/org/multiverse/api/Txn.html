<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_31) on Sat Apr 07 12:47:24 EEST 2012 -->
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<TITLE>
Txn (The Multiverse Code (so API and implementation) 0.7.0 API)
</TITLE>

<META NAME="date" CONTENT="2012-04-07">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="Txn (The Multiverse Code (so API and implementation) 0.7.0 API)";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/Txn.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../org/multiverse/api/TraceLevel.html" title="enum in org.multiverse.api"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../org/multiverse/api/TxnConfig.html" title="interface in org.multiverse.api"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?org/multiverse/api/Txn.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="Txn.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
org.multiverse.api</FONT>
<BR>
Interface Txn</H2>
<DL>
<DT><B>All Known Implementing Classes:</B> <DD><A HREF="../../../org/multiverse/stms/gamma/transactions/fat/FatFixedLengthGammaTxn.html" title="class in org.multiverse.stms.gamma.transactions.fat">FatFixedLengthGammaTxn</A>, <A HREF="../../../org/multiverse/stms/gamma/transactions/fat/FatMonoGammaTxn.html" title="class in org.multiverse.stms.gamma.transactions.fat">FatMonoGammaTxn</A>, <A HREF="../../../org/multiverse/stms/gamma/transactions/fat/FatVariableLengthGammaTxn.html" title="class in org.multiverse.stms.gamma.transactions.fat">FatVariableLengthGammaTxn</A>, <A HREF="../../../org/multiverse/stms/gamma/transactions/GammaTxn.html" title="class in org.multiverse.stms.gamma.transactions">GammaTxn</A>, <A HREF="../../../org/multiverse/stms/gamma/transactions/lean/LeanFixedLengthGammaTxn.html" title="class in org.multiverse.stms.gamma.transactions.lean">LeanFixedLengthGammaTxn</A>, <A HREF="../../../org/multiverse/stms/gamma/transactions/lean/LeanMonoGammaTxn.html" title="class in org.multiverse.stms.gamma.transactions.lean">LeanMonoGammaTxn</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public interface <B>Txn</B></DL>
</PRE>

<P>
The unit of work for <A HREF="../../../org/multiverse/api/Stm.html" title="interface in org.multiverse.api"><CODE>Stm</CODE></A>. The transaction make sure that changes on <A HREF="../../../org/multiverse/api/TxnObject.html" title="interface in org.multiverse.api"><CODE>TxnObject</CODE></A> instances are:
 <ol>
 <li>Atomic: all or nothing gets committed (Failure atomicity)</li>
 <li>Consistent : </li>
 <li>Isolated: a transaction is executed isolated from other transactions. Meaning that a transaction won't see changed made by
 transactions executed concurrently, but it will see changes made by transaction completed before. It depends on the
 <A HREF="../../../org/multiverse/api/IsolationLevel.html" title="enum in org.multiverse.api"><CODE>IsolationLevel</CODE></A> or <A HREF="../../../org/multiverse/api/LockMode.html" title="enum in org.multiverse.api"><CODE>LockMode</CODE></A> used how strict the isolation is.</li>
 </ol>

 <h3>Thread-safety</h3>

 <p>A Txn is not thread-safe (just like a Hibernate Session is not thread-safe to use). It can be
 handed over from thread to thread, but one needs to be really careful with the <A HREF="../../../org/multiverse/api/TxnThreadLocal.html" title="class in org.multiverse.api"><CODE>TxnThreadLocal</CODE></A> or other
 thread specific state like the stackframe of a method (this is an issue when instrumentation is used since the stackframe
 is likely to be enhanced to include the Txn as a local variable.

 <h3>TxnListener</h3>

 <p>It is possible to listen to a Txn when it aborts/prepares/commits/starts. There are 2 different flavors of
 listeners:
 <ol>
 <li>normal listeners: are registered during the execution of a transaction using the
 <A HREF="../../../org/multiverse/api/Txn.html#register(org.multiverse.api.lifecycle.TxnListener)"><CODE>register(org.multiverse.api.lifecycle.TxnListener)</CODE></A> method. If the transactions aborts/commits
 these listeners are removed. So if the transaction is retried, the listeners need to be registered (this is easy since
 the logic inside the transactional closure that did the register, is executed again.
 </li>
 <li>permanent listeners: are registered once and will always remain. It can be done on the
 TxnExecutor level using the <A HREF="../../../org/multiverse/api/TxnFactoryBuilder.html#addPermanentListener(org.multiverse.api.lifecycle.TxnListener)"><CODE>TxnFactoryBuilder.addPermanentListener(org.multiverse.api.lifecycle.TxnListener)</CODE></A>
 or it can be done on the Stm level. Permanent listeners are suited for products that want to integrate with Multiverse and always
 execute some logic at important transaction events. Registration of permanent can also be done on the <A HREF="../../../org/multiverse/api/Stm.html" title="interface in org.multiverse.api"><CODE>Stm</CODE></A> level. See
 the implementations for more details. Permanent listeners are always executed after the normal listeners.
 </li>
 </ol>

 <h3>Storing transaction references</h3>

 <p>Txn instances should not be stored since they are likely to be pooled by the STM. So it could be that the same
 transaction instance is re-used to execute a completely unrelated piece of logic, and it can also be that different instances
 are used to execute the same logic.
<P>

<P>
<DL>
<DT><B>Author:</B></DT>
  <DD>Peter Veentjer.</DD>
</DL>
<HR>

<P>

<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/multiverse/api/Txn.html#abort()">abort</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Aborts this Txn.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/multiverse/api/Txn.html#commit()">commit</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Commits this Txn.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/multiverse/api/Txn.html#getAttempt()">getAttempt</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the current attempt (so the number of tries this transaction already had).</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../org/multiverse/api/TxnConfig.html" title="interface in org.multiverse.api">TxnConfig</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/multiverse/api/Txn.html#getConfig()">getConfig</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the TxnConfig used by this Txn.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;long</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/multiverse/api/Txn.html#getRemainingTimeoutNs()">getRemainingTimeoutNs</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the remaining timeout in nanoseconds.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../org/multiverse/api/TxnStatus.html" title="enum in org.multiverse.api">TxnStatus</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/multiverse/api/Txn.html#getStatus()">getStatus</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the status of this Txn.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/multiverse/api/Txn.html#isAbortOnly()">isAbortOnly</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks if this Txn is abort only (so will always fail when committing or preparing).</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/multiverse/api/Txn.html#prepare()">prepare</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Prepares this transaction to be committed.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/multiverse/api/Txn.html#register(org.multiverse.api.lifecycle.TxnListener)">register</A></B>(<A HREF="../../../org/multiverse/api/lifecycle/TxnListener.html" title="interface in org.multiverse.api.lifecycle">TxnListener</A>&nbsp;listener)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Registers a TxnListener.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/multiverse/api/Txn.html#retry()">retry</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Retries the transaction.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/multiverse/api/Txn.html#setAbortOnly()">setAbortOnly</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Signals that the only possible outcome of the Txn is one that aborts.</TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="getConfig()"><!-- --></A><H3>
getConfig</H3>
<PRE>
<A HREF="../../../org/multiverse/api/TxnConfig.html" title="interface in org.multiverse.api">TxnConfig</A> <B>getConfig</B>()</PRE>
<DL>
<DD>Returns the TxnConfig used by this Txn.

 <p>Because the Txn can be reused, the TxnConfig used by this Txn doesn't need to be constant.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the TxnConfig.</DL>
</DD>
</DL>
<HR>

<A NAME="getStatus()"><!-- --></A><H3>
getStatus</H3>
<PRE>
<A HREF="../../../org/multiverse/api/TxnStatus.html" title="enum in org.multiverse.api">TxnStatus</A> <B>getStatus</B>()</PRE>
<DL>
<DD>Returns the status of this Txn.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the status of this Txn.</DL>
</DD>
</DL>
<HR>

<A NAME="getAttempt()"><!-- --></A><H3>
getAttempt</H3>
<PRE>
int <B>getAttempt</B>()</PRE>
<DL>
<DD>Gets the current attempt (so the number of tries this transaction already had). Value will
 always be equal or larger than 1 (the first attempt returns 1). The maximum number of attempts for retrying is determined based
 on the  <A HREF="../../../org/multiverse/api/TxnConfig.html#getMaxRetries()"><CODE>TxnConfig.getMaxRetries()</CODE></A>
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the current attempt.</DL>
</DD>
</DL>
<HR>

<A NAME="getRemainingTimeoutNs()"><!-- --></A><H3>
getRemainingTimeoutNs</H3>
<PRE>
long <B>getRemainingTimeoutNs</B>()</PRE>
<DL>
<DD>Gets the remaining timeout in nanoseconds. Long.MAX_VALUE indicates that no timeout is used.

 <p>The remaining timeout only is decreased if a transaction blocks on a retry or when doing
 a backoff.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the remaining timeout.</DL>
</DD>
</DL>
<HR>

<A NAME="commit()"><!-- --></A><H3>
commit</H3>
<PRE>
void <B>commit</B>()</PRE>
<DL>
<DD>Commits this Txn. If the Txn is:
 <ol>
 <li>active: it is prepared for commit and then committed</li>
 <li>prepared: it is committed. Once it is prepared, the commit is guaranteed to
 succeed.</li>
 <li>aborted: a DeadTxnException is thrown</li>
 <li>committed: the call is ignored</li>
 </ol>

 <p>Txn will always be aborted if the commit does not succeed.

 <p>Commit will not throw a <A HREF="../../../org/multiverse/api/exceptions/ReadWriteConflict.html" title="class in org.multiverse.api.exceptions"><CODE>ReadWriteConflict</CODE></A> after the transaction is prepared.
 So if prepared successfully, a commit will always succeed.

 <p>If there are TxnListeners (either normal ones or permanent ones) and they thrown a <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/RuntimeException.html?is-external=true" title="class or interface in java.lang"><CODE>RuntimeException</CODE></A>
 or <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Error.html?is-external=true" title="class or interface in java.lang"><CODE>Error</CODE></A>, this will be re-thrown. If a listener fails after the prepare/commit  the transaction still is
 committed.
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../org/multiverse/api/exceptions/ReadWriteConflict.html" title="class in org.multiverse.api.exceptions">ReadWriteConflict</A></CODE> - if the commit failed. Check the class hierarchy of the ReadWriteConflict for more information.
<DD><CODE><A HREF="../../../org/multiverse/api/exceptions/IllegalTxnStateException.html" title="class in org.multiverse.api.exceptions">IllegalTxnStateException</A></CODE> - if the Txn is not in the correct
          state for this operation.</DL>
</DD>
</DL>
<HR>

<A NAME="prepare()"><!-- --></A><H3>
prepare</H3>
<PRE>
void <B>prepare</B>()</PRE>
<DL>
<DD>Prepares this transaction to be committed. It can lock resources to make sure that no conflicting changes are
 made after the transaction has been prepared. If the transaction already is prepared, the call is ignored.  If
 the prepare fails, the transaction automatically is aborted. Once a transaction is prepared, the commit will
 always succeed.

 <p>It is very important that the transaction eventually commits or aborts, if it doesn't no other transaction
 reading/writing the committed resources, can't commit.
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../org/multiverse/api/exceptions/ReadWriteConflict.html" title="class in org.multiverse.api.exceptions">ReadWriteConflict</A></CODE> - if the transaction can't be prepared.
<DD><CODE><A HREF="../../../org/multiverse/api/exceptions/DeadTxnException.html" title="class in org.multiverse.api.exceptions">DeadTxnException</A></CODE> - if the transaction already is committed or aborted.</DL>
</DD>
</DL>
<HR>

<A NAME="abort()"><!-- --></A><H3>
abort</H3>
<PRE>
void <B>abort</B>()</PRE>
<DL>
<DD>Aborts this Txn. This means that the changes made in this transaction are not committed. It depends on
 the implementation if this operation is simple (ditching objects for example), or if changes need to be rolled
 back. If an exception is thrown while executing the abort, the transaction is still aborted. And example of
 such a situation is a pre-abort task that fails. So the transaction always is aborted (unless it is committed).

 <p>If the Txn already is aborted, the call is ignored.
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../org/multiverse/api/exceptions/IllegalTxnStateException.html" title="class in org.multiverse.api.exceptions">IllegalTxnStateException</A></CODE> - if the Txn is not in the correct state for this operation.</DL>
</DD>
</DL>
<HR>

<A NAME="retry()"><!-- --></A><H3>
retry</H3>
<PRE>
void <B>retry</B>()</PRE>
<DL>
<DD>Retries the transaction. This call doesn't block, but if all goes well a <A HREF="../../../org/multiverse/api/exceptions/RetryError.html" title="class in org.multiverse.api.exceptions"><CODE>RetryError</CODE></A>
 is thrown which is caught by the <A HREF="../../../org/multiverse/api/TxnExecutor.html" title="interface in org.multiverse.api"><CODE>TxnExecutor</CODE></A>.
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../org/multiverse/api/exceptions/TxnExecutionException.html" title="class in org.multiverse.api.exceptions">TxnExecutionException</A></CODE> - if the transaction is not in a legal state for
          this operation.
<DD><CODE><A HREF="../../../org/multiverse/api/exceptions/ControlFlowError.html" title="class in org.multiverse.api.exceptions">ControlFlowError</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="setAbortOnly()"><!-- --></A><H3>
setAbortOnly</H3>
<PRE>
void <B>setAbortOnly</B>()</PRE>
<DL>
<DD>Signals that the only possible outcome of the Txn is one that aborts. When the transaction prepares or
 commits it checks if the transaction is marked as abort only. If so, it will automatically aborted and an
 <A HREF="../../../org/multiverse/api/exceptions/AbortOnlyException.html" title="class in org.multiverse.api.exceptions"><CODE>AbortOnlyException</CODE></A> is thrown.

 <p>This method is not threadsafe, so can only be called by the thread that used the transaction.
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../org/multiverse/api/exceptions/IllegalTxnStateException.html" title="class in org.multiverse.api.exceptions">IllegalTxnStateException</A></CODE> - if the transaction is not active.
<DD><CODE><A HREF="../../../org/multiverse/api/exceptions/ControlFlowError.html" title="class in org.multiverse.api.exceptions">ControlFlowError</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="isAbortOnly()"><!-- --></A><H3>
isAbortOnly</H3>
<PRE>
boolean <B>isAbortOnly</B>()</PRE>
<DL>
<DD>Checks if this Txn is abort only (so will always fail when committing or preparing).

 <p>This method is not threadsafe, so can only be called by the thread that used the transaction.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>true if abort only, false otherwise.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../org/multiverse/api/exceptions/DeadTxnException.html" title="class in org.multiverse.api.exceptions">DeadTxnException</A></CODE> - if the transaction is committed/aborted.</DL>
</DD>
</DL>
<HR>

<A NAME="register(org.multiverse.api.lifecycle.TxnListener)"><!-- --></A><H3>
register</H3>
<PRE>
void <B>register</B>(<A HREF="../../../org/multiverse/api/lifecycle/TxnListener.html" title="interface in org.multiverse.api.lifecycle">TxnListener</A>&nbsp;listener)</PRE>
<DL>
<DD>Registers a TxnListener. Every time a transaction is retried, the listener needs to
 be registered again if you want the task to be executed again. If you want a permanent listener, have
 a look at the <A HREF="../../../org/multiverse/api/TxnFactoryBuilder.html#addPermanentListener(org.multiverse.api.lifecycle.TxnListener)"><CODE>TxnFactoryBuilder.addPermanentListener(org.multiverse.api.lifecycle.TxnListener)</CODE></A>.

 <p>If a TxnListener is added more than once, it is executed more than once. No checks
 are made. The permanent listeners are executed in the order they are added.

 <p>If a TxnListener throws an Error/RuntimeException and the transaction still is alive,
 it is aborted. For compensating and deferred actions this is not an issue, but for the PrePrepare state
 or the state it could since the transaction is aborted.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>listener</CODE> - the listener to add.
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/NullPointerException.html?is-external=true" title="class or interface in java.lang">NullPointerException</A></CODE> - if listener is null. If the transaction is still alive, it is aborted.
<DD><CODE><A HREF="../../../org/multiverse/api/exceptions/IllegalTxnStateException.html" title="class in org.multiverse.api.exceptions">IllegalTxnStateException</A></CODE> - if the transaction is not in the correct
                              state (e.g. aborted or committed).
<DD><CODE><A HREF="../../../org/multiverse/api/exceptions/ControlFlowError.html" title="class in org.multiverse.api.exceptions">ControlFlowError</A></CODE></DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/Txn.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../org/multiverse/api/TraceLevel.html" title="enum in org.multiverse.api"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../org/multiverse/api/TxnConfig.html" title="interface in org.multiverse.api"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?org/multiverse/api/Txn.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="Txn.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
Copyright &#169; 2012. All Rights Reserved.
</BODY>
</HTML>
