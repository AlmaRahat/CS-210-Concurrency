<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_31) on Sat Apr 07 12:47:24 EEST 2012 -->
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<TITLE>
Lock (The Multiverse Code (so API and implementation) 0.7.0 API)
</TITLE>

<META NAME="date" CONTENT="2012-04-07">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="Lock (The Multiverse Code (so API and implementation) 0.7.0 API)";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/Lock.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../org/multiverse/api/IsolationLevel.html" title="enum in org.multiverse.api"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../org/multiverse/api/LockMode.html" title="enum in org.multiverse.api"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?org/multiverse/api/Lock.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="Lock.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
org.multiverse.api</FONT>
<BR>
Interface Lock</H2>
<DL>
<DT><B>All Known Implementing Classes:</B> <DD><A HREF="../../../org/multiverse/stms/gamma/transactionalobjects/AbstractGammaObject.html" title="class in org.multiverse.stms.gamma.transactionalobjects">AbstractGammaObject</A>, <A HREF="../../../org/multiverse/stms/gamma/transactionalobjects/BaseGammaTxnRef.html" title="class in org.multiverse.stms.gamma.transactionalobjects">BaseGammaTxnRef</A>, <A HREF="../../../org/multiverse/stms/gamma/transactionalobjects/GammaTxnBoolean.html" title="class in org.multiverse.stms.gamma.transactionalobjects">GammaTxnBoolean</A>, <A HREF="../../../org/multiverse/stms/gamma/transactionalobjects/GammaTxnDouble.html" title="class in org.multiverse.stms.gamma.transactionalobjects">GammaTxnDouble</A>, <A HREF="../../../org/multiverse/stms/gamma/transactionalobjects/GammaTxnInteger.html" title="class in org.multiverse.stms.gamma.transactionalobjects">GammaTxnInteger</A>, <A HREF="../../../org/multiverse/stms/gamma/transactionalobjects/GammaTxnLong.html" title="class in org.multiverse.stms.gamma.transactionalobjects">GammaTxnLong</A>, <A HREF="../../../org/multiverse/stms/gamma/transactionalobjects/GammaTxnRef.html" title="class in org.multiverse.stms.gamma.transactionalobjects">GammaTxnRef</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public interface <B>Lock</B></DL>
</PRE>

<P>
The Lock provides access to pessimistic behavior of a <A HREF="../../../org/multiverse/api/TxnObject.html" title="interface in org.multiverse.api"><CODE>TxnObject</CODE></A>. STM normally is very optimistic, but
 in some cases a more pessimistic approach (one with less retries) could be a better fitting solution.
 <p/>
 There are 4 different types of lockmodes:
 <ul>
 <li><b>LockMode.None:</b> it doesn't do any locking</li>
 <li><b>LockMode.Read:</b> it allows multiple transactions to acquire the read lock, but transaction acquiring the write-lock
 or exclusive lock (needed when a transaction wants to commit) is prohibited. If the read lock is acquired by a different
 transaction, a transaction still is able to read/write, but it isn't allowed to commit the changes (since and exclusive
 lock is required for that).
 </li>
 <li><b>LockMode.Write:</b> it allows only one transaction to acquire the write lock, but unlike a traditional
 write-lock, reads still are allowed. Normally this would not be acceptable because once the write-lock
 is acquired, the internals could be modified. But in case of STM, the STM can still provide a consistent view
 even though the locking transaction has made changes. This essentially is the same behavior you get with the
 'select for update' from Oracle. Once the write lock is acquired, other transactions can't acquire the Lock.
 </li>
 <li><b>LockMode.Exclusive:</b> it allows only one transaction to acquire the commit lock, and readers are not
 allowed to read anymore. From an isolation perspective, the exclusive lock looks a lot like the synchronized
 statement (or a <A HREF="http://download.oracle.com/javase/6/docs/api/java/util/concurrent/locks/ReentrantLock.html?is-external=true" title="class or interface in java.util.concurrent.locks"><CODE>ReentrantLock</CODE></A>} where only mutually exclusive access is
 possible. The exclusive lock normally is used by the STM when it commits.</li>
 </ul>

 <h3>Lock duration and release</h3>

 <p>Locks atm are acquired for the remaining duration of the transaction and only will always be automatically
 released once the transaction commits/aborts. This is essentially the same behavior you get with Oracle once
 a update/delete/insert is done, or when the record is locked manually by executing the 'select for update'. For
 this to work it is very important that the <A HREF="../../../org/multiverse/api/exceptions/ControlFlowError.html" title="class in org.multiverse.api.exceptions"><CODE>ControlFlowError</CODE></A> is not caught
 by the logic executed in an transactional closure, but is caught by the TxnExecutor itself.

 <h3>Blocking</h3>

 <p>Atm it isn't possible to block on a lock. What happens is that some spinning is done
 <A HREF="../../../org/multiverse/api/TxnFactoryBuilder.html#setSpinCount(int)"><CODE>TxnFactoryBuilder.setSpinCount(int)</CODE></A> and then some retries
 <A HREF="../../../org/multiverse/api/TxnFactoryBuilder.html#setMaxRetries(int)"><CODE>TxnFactoryBuilder.setMaxRetries(int)</CODE></A> in combination with a backoff
 <A HREF="../../../org/multiverse/api/TxnFactoryBuilder.html#setBackoffPolicy(org.multiverse.api.BackoffPolicy)"><CODE>TxnFactoryBuilder.setBackoffPolicy(BackoffPolicy)</CODE></A>. In the 0.8 release blocking will
 probably be added.

 <h3>Fairness</h3>

 <p>Atm there is no support for fairness. The big problem with fairness and STM is that the locks are released
 and the transaction needs to begin again. It could be that a lower priority transaction is faster and acquires
 the lock again. This is a topic that needs more research and probably will be integrated in the contention
 management.

 <h3>Lock upgrade</h3>

 <p>It is possible to upgrade a lock to more strict version, e.g. to upgrade a read-lock to a write-lock.
 The following upgrades are possible:
 <ol>
 <li>LockMode.Read->LockMode.Write: as long as no other transaction has acquired the Lock in LockMode.Read</li>
 <li>LockMode.Read->LockMode.Exclusive: as long as no other transaction has acquired the Lock in LockMode.Read</li>
 <li>LockMode.Write->LockMode.Exclusive: will always succeed</li>
 </ol>
 <p>
 The Txn is allowed to apply a more strict LockMode than the one specified.

 <h3>Lock downgrade</h3>

 <p>Downgrading locks currently is not possible and downgrade calls are ignored.

 <h3>Locking scope</h3>

 <p>Locking can be done on the Txn level (see the <A HREF="../../../org/multiverse/api/TxnFactoryBuilder.html#setReadLockMode(org.multiverse.api.LockMode)"><CODE>TxnFactoryBuilder.setReadLockMode(LockMode)</CODE></A> and
 <A HREF="../../../org/multiverse/api/TxnFactoryBuilder.html#setWriteLockMode(org.multiverse.api.LockMode)"><CODE>TxnFactoryBuilder.setWriteLockMode(LockMode)</CODE></A> where all reads or all writes (to do a write also a read
 is needed) are locked automatically. It can also be done on the reference level using
 getAndLock/setAndLock/getAndSetAndLock methods or by accessing the <A HREF="../../../org/multiverse/api/TxnObject.html#getLock()"><CODE>TxnObject.getLock()</CODE></A>.

 <h3>Lock escalation</h3>

 <p>In traditional lock based databases, managing locks in memory can be quite expensive. That is one of the reason why
 different Lock granularities are used (record level, page level, table level for example). To prevent managing too many
 locks, some databases apply lock escalation so that multiple low granularity locks are upgraded to a single higher granular
 lock. The problem with lock escalations is that the system could be subject to lock contention and to deadlocks.

 <p>The GammaStm (the main STM implementation) doesn't use lock escalation, but keeps on managing locks on the transactional object
 (ref) level.

 <h3>Deadlocks</h3>

 <p>2 Ingredients are needed for a deadlock:
 <ol>
 <li>Transactions acquiring locks in a different order</li>
 <li>Transactions that do an unbound waiting for a lock to come available</li>
 </ol>
 The problem with applying locks in the same order is that it places an extra borden on the developer. That is why atm the second
 ingredient is always missing if the GammaStm (the default STM implementation) is used. Therefor a developer doesn't need to worry about
 deadlocks (although it shifts the problem to an increased chance of starvation and livelocks).
<P>

<P>
<DL>
<DT><B>Author:</B></DT>
  <DD>Peter Veentjer.</DD>
<DT><B>See Also:</B><DD><A HREF="../../../org/multiverse/api/TxnFactoryBuilder.html#setReadLockMode(org.multiverse.api.LockMode)"><CODE>TxnFactoryBuilder.setReadLockMode(LockMode)</CODE></A>, 
<A HREF="../../../org/multiverse/api/TxnFactoryBuilder.html#setWriteLockMode(org.multiverse.api.LockMode)"><CODE>TxnFactoryBuilder.setWriteLockMode(LockMode)</CODE></A></DL>
<HR>

<P>

<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/multiverse/api/Lock.html#acquire(org.multiverse.api.LockMode)">acquire</A></B>(<A HREF="../../../org/multiverse/api/LockMode.html" title="enum in org.multiverse.api">LockMode</A>&nbsp;desiredLockMode)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Acquires a Lock with the provided LockMode.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/multiverse/api/Lock.html#acquire(org.multiverse.api.Txn, org.multiverse.api.LockMode)">acquire</A></B>(<A HREF="../../../org/multiverse/api/Txn.html" title="interface in org.multiverse.api">Txn</A>&nbsp;txn,
        <A HREF="../../../org/multiverse/api/LockMode.html" title="enum in org.multiverse.api">LockMode</A>&nbsp;desiredLockMode)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Acquires a Lock with the provided LockMode using the provided transaction.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../org/multiverse/api/LockMode.html" title="enum in org.multiverse.api">LockMode</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/multiverse/api/Lock.html#atomicGetLockMode()">atomicGetLockMode</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the current LockMode.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../org/multiverse/api/LockMode.html" title="enum in org.multiverse.api">LockMode</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/multiverse/api/Lock.html#getLockMode()">getLockMode</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the LockMode the transaction stored in the the <A HREF="../../../org/multiverse/api/TxnThreadLocal.html" title="class in org.multiverse.api"><CODE>TxnThreadLocal</CODE></A> has on this Lock.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../org/multiverse/api/LockMode.html" title="enum in org.multiverse.api">LockMode</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/multiverse/api/Lock.html#getLockMode(org.multiverse.api.Txn)">getLockMode</A></B>(<A HREF="../../../org/multiverse/api/Txn.html" title="interface in org.multiverse.api">Txn</A>&nbsp;txn)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the LockMode the transaction has on the Lock.</TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="atomicGetLockMode()"><!-- --></A><H3>
atomicGetLockMode</H3>
<PRE>
<A HREF="../../../org/multiverse/api/LockMode.html" title="enum in org.multiverse.api">LockMode</A> <B>atomicGetLockMode</B>()</PRE>
<DL>
<DD>Returns the current LockMode. This call doesn't look at any running transaction, it shows the actual
 state of the Lock. The value could be stale as soon as it is received. To retrieve the LockMode a
 a Txn has on a Lock, the <A HREF="../../../org/multiverse/api/Lock.html#getLockMode()"><CODE>getLockMode()</CODE></A> or <A HREF="../../../org/multiverse/api/Lock.html#getLockMode(org.multiverse.api.Txn)"><CODE>getLockMode(Txn)</CODE></A> need
 to be used.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the current LockMode.</DL>
</DD>
</DL>
<HR>

<A NAME="getLockMode()"><!-- --></A><H3>
getLockMode</H3>
<PRE>
<A HREF="../../../org/multiverse/api/LockMode.html" title="enum in org.multiverse.api">LockMode</A> <B>getLockMode</B>()</PRE>
<DL>
<DD>Gets the LockMode the transaction stored in the the <A HREF="../../../org/multiverse/api/TxnThreadLocal.html" title="class in org.multiverse.api"><CODE>TxnThreadLocal</CODE></A> has on this Lock.
 To retrieve the actual LockMode of the Lock, you need to use the <A HREF="../../../org/multiverse/api/Lock.html#atomicGetLockMode()"><CODE>atomicGetLockMode()</CODE></A>.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the LockMode.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../org/multiverse/api/exceptions/TxnExecutionException.html" title="class in org.multiverse.api.exceptions">TxnExecutionException</A></CODE> - if something failed while using the transaction. The transaction is guaranteed to have been aborted.
<DD><CODE><A HREF="../../../org/multiverse/api/exceptions/ControlFlowError.html" title="class in org.multiverse.api.exceptions">ControlFlowError</A></CODE> - if the Stm needs to control the flow in a different way than normal returns of exceptions. The transaction
          is guaranteed to have been aborted.<DT><B>See Also:</B><DD><A HREF="../../../org/multiverse/api/Lock.html#atomicGetLockMode()"><CODE>atomicGetLockMode()</CODE></A>, 
<A HREF="../../../org/multiverse/api/Lock.html#getLockMode(org.multiverse.api.Txn)"><CODE>getLockMode(Txn)</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="getLockMode(org.multiverse.api.Txn)"><!-- --></A><H3>
getLockMode</H3>
<PRE>
<A HREF="../../../org/multiverse/api/LockMode.html" title="enum in org.multiverse.api">LockMode</A> <B>getLockMode</B>(<A HREF="../../../org/multiverse/api/Txn.html" title="interface in org.multiverse.api">Txn</A>&nbsp;txn)</PRE>
<DL>
<DD>Gets the LockMode the transaction has on the Lock. This call makes use of the tx. To retrieve the actual
 LockMode of the Lock, you need to use the <A HREF="../../../org/multiverse/api/Lock.html#atomicGetLockMode()"><CODE>atomicGetLockMode()</CODE></A>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>txn</CODE> - the Lock
<DT><B>Returns:</B><DD>the LockMode the transaction has on the Lock.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../org/multiverse/api/exceptions/TxnExecutionException.html" title="class in org.multiverse.api.exceptions">TxnExecutionException</A></CODE> - if something failed while using the transaction. The transaction is guaranteed to have been aborted.
<DD><CODE><A HREF="../../../org/multiverse/api/exceptions/ControlFlowError.html" title="class in org.multiverse.api.exceptions">ControlFlowError</A></CODE> - if the Stm needs to control the flow in a different way than normal returns of exceptions. The transaction
          is guaranteed to have been aborted.<DT><B>See Also:</B><DD><A HREF="../../../org/multiverse/api/Lock.html#atomicGetLockMode()"><CODE>atomicGetLockMode()</CODE></A>, 
<A HREF="../../../org/multiverse/api/Lock.html#getLockMode(org.multiverse.api.Txn)"><CODE>getLockMode(Txn)</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="acquire(org.multiverse.api.LockMode)"><!-- --></A><H3>
acquire</H3>
<PRE>
void <B>acquire</B>(<A HREF="../../../org/multiverse/api/LockMode.html" title="enum in org.multiverse.api">LockMode</A>&nbsp;desiredLockMode)</PRE>
<DL>
<DD>Acquires a Lock with the provided LockMode. This call doesn't block if the Lock can't be upgraded, but throws
 a <A HREF="../../../org/multiverse/api/exceptions/ReadWriteConflict.html" title="class in org.multiverse.api.exceptions"><CODE>ReadWriteConflict</CODE></A>. It could also  be that the Lock is acquired, but the
 Txn sees that it isn't consistent anymore. In that case also a
 <A HREF="../../../org/multiverse/api/exceptions/ReadWriteConflict.html" title="class in org.multiverse.api.exceptions"><CODE>ReadWriteConflict</CODE></A> is thrown.

 <p>This call makes use of the Txn stored in the <A HREF="../../../org/multiverse/api/TxnThreadLocal.html" title="class in org.multiverse.api"><CODE>TxnThreadLocal</CODE></A>.

 <p>If the lockMode is lower than the LockMode the transaction already has on this Lock, the call is ignored.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>desiredLockMode</CODE> - the desired lockMode.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../org/multiverse/api/exceptions/TxnExecutionException.html" title="class in org.multiverse.api.exceptions">TxnExecutionException</A></CODE> - if something failed while using the transaction. The transaction is guaranteed to have been aborted.
<DD><CODE><A HREF="../../../org/multiverse/api/exceptions/ControlFlowError.html" title="class in org.multiverse.api.exceptions">ControlFlowError</A></CODE> - if the Stm needs to control the flow in a different way than normal returns of exceptions. The transaction
                              is guaranteed to have been aborted.
<DD><CODE><A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/NullPointerException.html?is-external=true" title="class or interface in java.lang">NullPointerException</A></CODE> - if desiredLockMode is null. If an alive transaction is available, it will
                              be aborted.</DL>
</DD>
</DL>
<HR>

<A NAME="acquire(org.multiverse.api.Txn, org.multiverse.api.LockMode)"><!-- --></A><H3>
acquire</H3>
<PRE>
void <B>acquire</B>(<A HREF="../../../org/multiverse/api/Txn.html" title="interface in org.multiverse.api">Txn</A>&nbsp;txn,
             <A HREF="../../../org/multiverse/api/LockMode.html" title="enum in org.multiverse.api">LockMode</A>&nbsp;desiredLockMode)</PRE>
<DL>
<DD>Acquires a Lock with the provided LockMode using the provided transaction. This call doesn't block if the Lock can't be
 upgraded but throws a <A HREF="../../../org/multiverse/api/exceptions/ReadWriteConflict.html" title="class in org.multiverse.api.exceptions"><CODE>ReadWriteConflict</CODE></A>. It could also be that the Lock is acquired,
 but the Txn sees that it isn't consistent anymore. In that case also a
 <A HREF="../../../org/multiverse/api/exceptions/ReadWriteConflict.html" title="class in org.multiverse.api.exceptions"><CODE>ReadWriteConflict</CODE></A> is thrown.

 <p>If the lockMode is lower than the LockMode the transaction already has on this Lock, the call is ignored.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>txn</CODE> - the Txn used for this operation.<DD><CODE>desiredLockMode</CODE> - the desired lockMode.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../org/multiverse/api/exceptions/TxnExecutionException.html" title="class in org.multiverse.api.exceptions">TxnExecutionException</A></CODE> - if something failed while using the transaction. The transaction is guaranteed to have been aborted.
<DD><CODE><A HREF="../../../org/multiverse/api/exceptions/ControlFlowError.html" title="class in org.multiverse.api.exceptions">ControlFlowError</A></CODE> - if the Stm needs to control the flow in a different way than normal returns of exceptions. The transaction
                              is guaranteed to have been aborted.
<DD><CODE><A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/NullPointerException.html?is-external=true" title="class or interface in java.lang">NullPointerException</A></CODE> - if tx or desiredLockMode is null. If an alive transaction is available, it will
                              be aborted.</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/Lock.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../org/multiverse/api/IsolationLevel.html" title="enum in org.multiverse.api"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../org/multiverse/api/LockMode.html" title="enum in org.multiverse.api"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?org/multiverse/api/Lock.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="Lock.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
Copyright &#169; 2012. All Rights Reserved.
</BODY>
</HTML>
